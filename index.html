<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>JDP CABS ‚Äî Live System</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@700;800;900&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
:root{--bg:#07090f;--card:#0d1219;--card2:#131b25;--border:#1a2535;--text:#eaf0fb;--muted:#4d6a8a;--yellow:#f59e0b;--green:#10b981;--red:#ef4444;--blue:#3b82f6;}
body.lm{--bg:#f0f4fb;--card:#fff;--card2:#e8eef8;--border:#c8d4e4;--text:#0c1929;--muted:#4d6a8a;}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--text);height:100vh;overflow:hidden;}
#map{position:absolute;inset:0;z-index:1;width:100vw;height:100vh;}
/* Leaflet dark mode tweaks */
body:not(.lm) .leaflet-layer, body:not(.lm) .leaflet-control-zoom-in, body:not(.lm) .leaflet-control-zoom-out, body:not(.lm) .leaflet-control-attribution {
  filter: invert(100%) hue-rotate(180deg) brightness(95%) contrast(90%);
}
#loader{position:fixed;inset:0;background:var(--bg);z-index:9999;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:16px;}
.ld-box{width:80px;height:80px;background:var(--yellow);border-radius:20px;display:flex;align-items:center;justify-content:center;font-family:'Syne',sans-serif;font-size:1.35rem;font-weight:900;color:#000;animation:ldp 2s infinite;}
@keyframes ldp{0%,100%{box-shadow:0 0 36px rgba(245,158,11,.45)}50%{box-shadow:0 0 64px rgba(245,158,11,.85)}}
.ld-t{font-family:'Syne',sans-serif;font-size:1.5rem;font-weight:900;letter-spacing:.06em;}
.ld-s{font-size:.75rem;color:var(--muted);}
.ld-bar-w{width:180px;height:3px;background:rgba(255,255,255,.07);border-radius:99px;overflow:hidden;}
.ld-bar{height:100%;width:0%;background:linear-gradient(90deg,var(--yellow),#f97316);border-radius:99px;transition:width .3s;}
#auth{position:fixed;inset:0;z-index:8000;display:none;flex-direction:column;background:var(--bg);overflow-y:auto;}
#auth::-webkit-scrollbar{display:none;}
.ah{position:relative;height:190px;overflow:hidden;flex-shrink:0;}
.ah img{width:100%;height:100%;object-fit:cover;opacity:.32;}
.ah-ov{position:absolute;inset:0;background:linear-gradient(to bottom,rgba(7,9,15,.1),rgba(7,9,15,1));display:flex;flex-direction:column;justify-content:flex-end;padding:20px;}
.ab{padding:0 16px 48px;}
.rtog{display:flex;gap:4px;background:rgba(255,255,255,.04);border:1px solid var(--border);border-radius:13px;padding:4px;margin-bottom:14px;}
.rtab{flex:1;padding:11px;border-radius:9px;border:none;background:transparent;color:var(--muted);font-weight:700;cursor:pointer;font-size:.87rem;font-family:'DM Sans',sans-serif;transition:all .15s;}
.rtab.ar{background:var(--yellow);color:#000;}
.rtab.ad{background:var(--green);color:#fff;}
.atabs{display:flex;gap:4px;background:rgba(255,255,255,.04);border:1px solid var(--border);border-radius:11px;padding:4px;margin-bottom:16px;}
.atab{flex:1;padding:9px;border-radius:8px;border:none;background:transparent;color:var(--muted);font-weight:700;cursor:pointer;font-family:'DM Sans',sans-serif;transition:all .15s;}
.atab.on{background:var(--card2);color:var(--text);}
.afrm{display:none;}.afrm.sh{display:block;animation:fup .3s ease;}
@keyframes fup{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
.fg{margin-bottom:12px;}
.fl{font-size:.65rem;font-weight:700;color:var(--muted);margin-bottom:5px;display:block;text-transform:uppercase;letter-spacing:.05em;}
.fi{width:100%;background:rgba(255,255,255,.04);border:1.5px solid var(--border);border-radius:11px;padding:12px 14px;color:var(--text);outline:none;font-family:'DM Sans',sans-serif;font-size:.9rem;transition:border-color .2s;}
.fi:focus{border-color:var(--yellow);}
.fi.gf:focus{border-color:var(--green);}
body.lm .fi{background:#fff;color:#000;}
.fr{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
.vg{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:12px;}
.vc{background:rgba(255,255,255,.04);border:1.5px solid var(--border);border-radius:11px;padding:11px;text-align:center;cursor:pointer;transition:all .2s;}
.vc.on{border-color:var(--green);background:rgba(16,185,129,.08);}
.asub{width:100%;border:none;border-radius:13px;padding:15px;font-size:.94rem;font-weight:800;cursor:pointer;font-family:'Syne',sans-serif;transition:opacity .2s;}
.asub:disabled{opacity:.5;cursor:not-allowed;}
.asub.y{background:var(--yellow);color:#000;}
.asub.g{background:var(--green);color:#fff;}
.fbb{display:inline-flex;align-items:center;gap:5px;border-radius:99px;padding:4px 11px;font-size:.63rem;font-weight:700;margin-bottom:13px;background:rgba(255,165,0,.1);border:1px solid rgba(255,165,0,.2);color:orange;}
.fbb.ok{background:rgba(16,185,129,.1);border-color:rgba(16,185,129,.2);color:var(--green);}
.fbb.er{background:rgba(239,68,68,.1);border-color:rgba(239,68,68,.2);color:var(--red);}
.eb{background:rgba(239,68,68,.1);border:1px solid rgba(239,68,68,.25);border-radius:11px;padding:10px 13px;font-size:.78rem;font-weight:600;color:var(--red);margin-bottom:11px;display:none;}
.tb{position:fixed;top:0;left:0;right:0;z-index:500;display:flex;justify-content:space-between;align-items:center;padding:11px 15px;background:linear-gradient(to bottom,rgba(0,0,0,.75),transparent);}
.tbtn{height:36px;background:rgba(0,0,0,.55);border:1px solid rgba(255,255,255,.11);border-radius:9px;display:flex;align-items:center;justify-content:center;cursor:pointer;padding:0 11px;font-size:.76rem;font-weight:700;color:var(--text);gap:5px;backdrop-filter:blur(8px);}
body.lm .tbtn{background:rgba(255,255,255,.85);color:#000;}
.locbtn{position:fixed;right:15px;z-index:500;width:44px;height:44px;background:white;border-radius:50%;border:none;cursor:pointer;font-size:1.05rem;box-shadow:0 4px 16px rgba(0,0,0,.35);display:flex;align-items:center;justify-content:center;transition:transform .15s;}
.locbtn:active{transform:scale(.9);}
.sheet{position:fixed;bottom:0;left:0;right:0;z-index:400;background:rgba(7,9,15,.97);backdrop-filter:blur(32px);border-radius:22px 22px 0 0;border-top:1px solid rgba(255,255,255,.07);padding:0 17px 34px;max-height:86vh;overflow-y:auto;display:none;}
.sheet::-webkit-scrollbar{display:none;}
body.lm .sheet{background:rgba(240,244,251,.97);}
.hdl{width:34px;height:4px;background:rgba(255,255,255,.1);border-radius:4px;margin:11px auto 17px;}
body.lm .hdl{background:rgba(0,0,0,.1);}
.scr{display:none;}.scr.on{display:block;animation:fup .3s ease;}
.mbtn{width:100%;border:none;border-radius:14px;padding:15px;font-size:.94rem;font-weight:800;cursor:pointer;margin-top:9px;font-family:'Syne',sans-serif;transition:transform .1s,opacity .2s;}
.mbtn:active{transform:scale(.98);}
.mbtn:disabled{opacity:.5;cursor:not-allowed;}
.mbtn.y{background:var(--yellow);color:#000;box-shadow:0 5px 18px rgba(245,158,11,.3);}
.mbtn.ro{background:rgba(239,68,68,.08);color:var(--red);border:1px solid rgba(239,68,68,.2);}
.mbtn.g{background:var(--green);color:#fff;box-shadow:0 5px 18px rgba(16,185,129,.25);}
.mbtn.b{background:var(--blue);color:#fff;}
.lbs{display:flex;flex-direction:column;margin-bottom:13px;}
.lb{display:flex;align-items:center;gap:11px;background:rgba(255,255,255,.04);border:1.5px solid var(--border);padding:12px 13px;transition:all .2s;}
.lb:first-child{border-radius:13px 13px 0 0;border-bottom:none;}
.lb:last-child{border-radius:0 0 13px 13px;}
.lb:last-child:focus-within{border-color:var(--yellow);}
body.lm .lb{background:rgba(0,0,0,.03);}
.pdot{width:10px;height:10px;background:var(--green);border-radius:50%;flex-shrink:0;animation:dpulse 2s infinite;}
@keyframes dpulse{0%,100%{box-shadow:0 0 5px var(--green)}50%{box-shadow:0 0 12px var(--green)}}
.lspin{width:9px;height:9px;border:2px solid rgba(16,185,129,.3);border-top:2px solid var(--green);border-radius:50%;animation:spin .8s linear infinite;flex-shrink:0;}
@keyframes spin{to{transform:rotate(360deg)}}
/* AUTOCOMPLETE */
.acw{position:relative;overflow:visible;flex:1;}
.ac-list{position:absolute;bottom:48px;left:-13px;right:-13px;background:var(--card);border:1px solid var(--border);border-radius:13px;overflow:hidden;box-shadow:0 -8px 32px rgba(0,0,0,.55);z-index:600;display:none;max-height:210px;overflow-y:auto;}
.ac-list.sh{display:block;animation:fup .2s ease;}
body.lm .ac-list{background:#fff;box-shadow:0 -8px 24px rgba(0,0,0,.15);}
.ac-item{padding:11px 14px;cursor:pointer;border-bottom:1px solid rgba(255,255,255,.04);display:flex;align-items:center;gap:10px;transition:background .15s;}
.ac-item:last-child{border-bottom:none;}
.ac-item:hover,.ac-item:active{background:rgba(245,158,11,.07);}
body.lm .ac-item{border-bottom-color:rgba(0,0,0,.05);}
.ai-ico{font-size:.9rem;flex-shrink:0;opacity:.65;}
.ai-main{font-size:.85rem;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.ai-sub{font-size:.67rem;color:var(--muted);margin-top:1px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.chips{display:flex;gap:7px;margin-bottom:13px;}
.chip{flex:1;background:rgba(255,255,255,.04);border:1px solid var(--border);border-radius:11px;padding:9px 7px;text-align:center;}
body.lm .chip{background:#f1f5f9;}
.cv{font-weight:800;font-size:.97rem;font-family:'Syne',sans-serif;}
.cl{font-size:.58rem;font-weight:600;color:var(--muted);margin-top:2px;text-transform:uppercase;letter-spacing:.04em;}
.ro-card{display:flex;align-items:center;padding:13px;background:rgba(255,255,255,.04);border:1.5px solid var(--border);border-radius:13px;margin-bottom:8px;cursor:pointer;transition:all .2s;}
.ro-card.sel{background:rgba(245,158,11,.06);border-color:var(--yellow);}
body.lm .ro-card{background:#fff;}
.rdr{text-align:center;padding:24px 0;}
.rdr-rings{position:relative;width:84px;height:84px;margin:0 auto 16px;}
.r1{position:absolute;inset:0;border:2px solid rgba(245,158,11,.12);border-radius:50%;}
.r2{position:absolute;inset:9px;border:2px solid rgba(245,158,11,.22);border-radius:50%;}
.r3{position:absolute;inset:19px;border:3px solid transparent;border-top:3px solid var(--yellow);border-radius:50%;animation:spin .9s linear infinite;}
.r4{position:absolute;inset:33px;background:var(--yellow);border-radius:50%;box-shadow:0 0 12px rgba(245,158,11,.8);}
.dcard{display:flex;align-items:center;gap:13px;margin-bottom:14px;padding:13px;background:rgba(255,255,255,.03);border:1px solid var(--border);border-radius:15px;}
body.lm .dcard{background:#fff;}
.dava{width:52px;height:52px;background:linear-gradient(135deg,#1e2d4a,#253a5e);border-radius:50%;font-size:1.9rem;display:flex;align-items:center;justify-content:center;flex-shrink:0;}
.otp{background:var(--card2);padding:8px 11px;border-radius:10px;border:1px solid var(--border);text-align:center;min-width:65px;}
.sbadge{display:flex;align-items:center;gap:7px;padding:8px 12px;border-radius:9px;margin-bottom:11px;font-size:.76rem;font-weight:600;}
.sbadge.g{background:rgba(16,185,129,.08);border:1px solid rgba(16,185,129,.2);color:var(--green);}
.sbadge.b{background:rgba(59,130,246,.08);border:1px solid rgba(59,130,246,.2);color:var(--blue);}
.sbd{width:7px;height:7px;border-radius:50%;flex-shrink:0;}
#dTopBar{position:fixed;top:0;left:0;right:0;z-index:500;display:none;padding:11px 15px;background:linear-gradient(to bottom,rgba(0,0,0,.8),transparent);}
.d-nr{display:flex;align-items:center;justify-content:space-between;}
.d-nm{font-family:'Syne',sans-serif;font-weight:800;font-size:.92rem;color:white;}
.tgsw{position:relative;width:52px;height:27px;cursor:pointer;}
.tgsw input{opacity:0;width:0;height:0;}
.tgtr{position:absolute;inset:0;background:#2d3748;border-radius:99px;transition:background .3s;border:1.5px solid rgba(255,255,255,.08);}
.tgsw input:checked+.tgtr{background:var(--green);}
.tgth{position:absolute;height:19px;width:19px;left:4px;top:50%;transform:translateY(-50%);background:white;border-radius:50%;transition:transform .3s;box-shadow:0 2px 5px rgba(0,0,0,.3);}
.tgsw input:checked~.tgth{transform:translateY(-50%) translateX(25px);}
#dStats{position:fixed;top:62px;left:0;right:0;z-index:499;display:none;padding:0 13px;}
.dsr{display:flex;gap:7px;}
.dst{background:rgba(7,9,15,.88);backdrop-filter:blur(14px);border:1px solid rgba(255,255,255,.08);border-radius:11px;padding:9px 12px;flex:1;text-align:center;}
.dsv{font-family:'Syne',sans-serif;font-weight:800;font-size:.95rem;color:var(--yellow);}
.dsl{font-size:.58rem;color:var(--muted);font-weight:600;text-transform:uppercase;margin-top:1px;}
#dPanel{position:fixed;bottom:0;left:0;right:0;z-index:400;display:none;}
#dOff{background:rgba(7,9,15,.97);backdrop-filter:blur(28px);border-radius:22px 22px 0 0;border-top:1px solid rgba(255,255,255,.06);padding:20px 17px 34px;text-align:center;}
body.lm #dOff{background:rgba(240,244,251,.97);}
#dOn{background:rgba(7,9,15,.97);backdrop-filter:blur(28px);border-radius:22px 22px 0 0;border-top:1px solid rgba(255,255,255,.06);padding:18px 17px 30px;display:none;}
body.lm #dOn{background:rgba(240,244,251,.97);}
.opulse{display:flex;align-items:center;gap:9px;background:rgba(16,185,129,.08);border:1px solid rgba(16,185,129,.2);border-radius:13px;padding:13px;margin-bottom:12px;}
.odpulse{width:9px;height:9px;background:var(--green);border-radius:50%;flex-shrink:0;animation:oping 1.8s infinite;}
@keyframes oping{0%{box-shadow:0 0 0 0 rgba(16,185,129,.5)}70%{box-shadow:0 0 0 9px rgba(16,185,129,0)}100%{box-shadow:0 0 0 0 rgba(16,185,129,0)}}
#reqPopup{position:fixed;bottom:-100%;left:0;right:0;z-index:700;transition:bottom .4s cubic-bezier(.34,1.56,.64,1);}
#reqPopup.sh{bottom:0;}
.rpc{background:var(--bg);border-radius:24px 24px 0 0;border-top:1px solid rgba(255,255,255,.1);padding:18px 17px 34px;box-shadow:0 -14px 50px rgba(0,0,0,.65);}
body.lm .rpc{background:#fff;}
.rtring{position:relative;width:60px;height:60px;margin:0 auto 13px;}
.rtsvg{transform:rotate(-90deg);}
.rtcbg{fill:none;stroke:rgba(255,255,255,.07);stroke-width:5;}
.rtc{fill:none;stroke:var(--yellow);stroke-width:5;stroke-linecap:round;stroke-dasharray:163;stroke-dashoffset:0;transition:stroke-dashoffset 1s linear;}
.rtn{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-family:'Syne',sans-serif;font-weight:900;font-size:1.25rem;color:var(--yellow);}
.trip-row{display:flex;align-items:stretch;gap:11px;margin:13px 0;}
.tdots{display:flex;flex-direction:column;align-items:center;gap:3px;padding-top:3px;}
.tdg{width:8px;height:8px;background:var(--green);border-radius:50%;flex-shrink:0;}
.tdl{width:2px;flex:1;background:rgba(255,255,255,.09);}
.tdr{width:8px;height:8px;background:var(--red);border-radius:50%;flex-shrink:0;}
.tadd{flex:1;min-width:0;}
.ta-row{padding:6px 0;border-bottom:1px solid rgba(255,255,255,.05);}
.ta-row:last-child{border-bottom:none;padding-bottom:0;}
.ta-lbl{font-size:.6rem;color:var(--muted);font-weight:700;text-transform:uppercase;letter-spacing:.04em;}
.ta-val{font-size:.86rem;font-weight:700;margin-top:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.req-btns{display:grid;grid-template-columns:1fr 1.6fr;gap:9px;margin-top:13px;}
#dNav{background:rgba(7,9,15,.97);backdrop-filter:blur(28px);border-radius:22px 22px 0 0;border-top:1px solid rgba(255,255,255,.07);padding:17px 17px 30px;display:none;}
body.lm #dNav{background:rgba(240,244,251,.97);}
.nstep{display:flex;align-items:center;gap:11px;border-radius:13px;padding:11px 13px;margin-bottom:10px;}
.nstep.bl{background:rgba(59,130,246,.08);border:1px solid rgba(59,130,246,.2);}
.nstep.gr{background:rgba(16,185,129,.08);border:1px solid rgba(16,185,129,.2);}
.nicon{width:38px;height:38px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.1rem;flex-shrink:0;}
.nstep.bl .nicon{background:rgba(59,130,246,.15);}
.nstep.gr .nicon{background:rgba(16,185,129,.15);}
.toast{position:fixed;top:78px;left:50%;transform:translateX(-50%);background:rgba(10,15,24,.97);border:1px solid rgba(255,255,255,.09);border-radius:99px;padding:9px 20px;font-size:.78rem;font-weight:600;z-index:9999;animation:tin .3s ease,tout .3s ease 2.5s forwards;white-space:nowrap;box-shadow:0 6px 24px rgba(0,0,0,.4);max-width:88vw;overflow:hidden;text-overflow:ellipsis;}
@keyframes tin{from{opacity:0;top:56px}to{opacity:1;top:78px}}
@keyframes tout{to{opacity:0}}
.pm{width:22px;height:22px;display:flex;align-items:center;justify-content:center;position:relative;}
.pd{width:12px;height:12px;background:var(--blue);border:2.5px solid white;border-radius:50%;z-index:2;}
.pr{position:absolute;width:100%;height:100%;background:var(--blue);border-radius:50%;animation:pr 1.6s ease-out infinite;}
@keyframes pr{0%{transform:scale(.8);opacity:.7}100%{transform:scale(2.8);opacity:0}}
.netb{position:fixed;bottom:0;left:50%;transform:translateX(-50%);z-index:9998;background:#ef4444;color:#fff;padding:5px 16px;font-size:.73rem;font-weight:700;border-radius:99px 99px 0 0;display:none;}
</style>
</head>
<body>

<div id="loader">
  <div class="ld-box">JDP</div>
  <div class="ld-t">CABS</div>
  <div class="ld-s">Jagdalpur's Live Booking System</div>
  <div class="ld-bar-w"><div class="ld-bar" id="ldBar"></div></div>
  <div id="ldSt" style="font-size:.7rem;color:var(--muted);margin-top:4px">Initializing...</div>
</div>

<div id="map"></div>

<div id="auth">
  <div class="ah">
    <img src="https://images.unsplash.com/photo-1449965408869-eaa3f722e40d?auto=format&fit=crop&w=800&q=80">
    <div class="ah-ov">
      <div style="font-family:'Syne',sans-serif;font-size:1.75rem;font-weight:900;color:white">JDP CABS</div>
      <div style="color:rgba(255,255,255,.5);font-size:.8rem;margin-top:3px">Jagdalpur ¬∑ Live Booking</div>
    </div>
  </div>
  <div class="ab">
    <div class="fbb" id="fbBadge">‚è≥ Connecting...</div>
    <div class="rtog">
      <button class="rtab ar" id="rTab" onclick="setRole('rider')">üßç Rider</button>
      <button class="rtab" id="dTab" onclick="setRole('driver')">üöñ Driver</button>
    </div>
    <div class="atabs">
      <button class="atab on" id="loginTab" onclick="setTab('login')">Login</button>
      <button class="atab" id="regTab" onclick="setTab('register')">Register</button>
    </div>
    <div class="afrm sh" id="loginForm">
      <div id="loginErr" class="eb"></div>
      <div class="fg"><label class="fl">Mobile Number</label><input type="tel" class="fi" id="lId" placeholder="9876543210" maxlength="10"></div>
      <div class="fg"><label class="fl">Password</label><input type="password" class="fi" id="lPass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"></div>
      <button class="asub y" id="loginBtn" onclick="doLogin()">üöÄ Login</button>
    </div>
    <div class="afrm" id="rRegForm">
      <div id="rRegErr" class="eb"></div>
      <div class="fr">
        <div class="fg"><label class="fl">Name</label><input type="text" class="fi" id="rFn" placeholder="Full Name"></div>
        <div class="fg"><label class="fl">Mobile</label><input type="tel" class="fi" id="rPh" placeholder="9876543210" maxlength="10"></div>
      </div>
      <div class="fg"><label class="fl">Password</label><input type="password" class="fi" id="rPw" placeholder="min 6 chars"></div>
      <button class="asub y" id="rRegBtn" onclick="doRiderReg()">‚úÖ Create Account</button>
    </div>
    <div class="afrm" id="dRegForm">
      <div id="dRegErr" class="eb"></div>
      <div class="fr">
        <div class="fg"><label class="fl">Name</label><input type="text" class="fi gf" id="dFn" placeholder="Full Name"></div>
        <div class="fg"><label class="fl">Mobile</label><input type="tel" class="fi gf" id="dPh" placeholder="9876543210" maxlength="10"></div>
      </div>
      <div class="fg"><label class="fl">Vehicle Number</label><input type="text" class="fi gf" id="dVeh" placeholder="CG 17 XX 0000"></div>
      <div class="fg"><label class="fl">Vehicle Type</label>
        <div class="vg">
          <div class="vc on" id="vAuto" onclick="selVeh('auto')"><div style="font-size:1.6rem">üõ∫</div><div style="font-size:.73rem;font-weight:700;margin-top:3px">Auto</div></div>
          <div class="vc" id="vCab" onclick="selVeh('cab')"><div style="font-size:1.6rem">üöó</div><div style="font-size:.73rem;font-weight:700;margin-top:3px">Mini Cab</div></div>
        </div>
      </div>
      <div class="fg"><label class="fl">Password</label><input type="password" class="fi gf" id="dPw" placeholder="min 6 chars"></div>
      <button class="asub g" id="dRegBtn" onclick="doDriverReg()">‚úÖ Register as Driver</button>
    </div>
  </div>
</div>

<div class="tb" id="rTop" style="display:none">
  <div style="font-family:'Syne',sans-serif;font-weight:900;color:white;font-size:.93rem;letter-spacing:.05em">JDP CABS</div>
  <div style="display:flex;gap:7px">
    <div class="tbtn" onclick="toggleTheme()">‚òÄÔ∏è</div>
    <div class="tbtn" id="zoneBtn" onclick="toggleZone()">üì°</div>
    <div class="tbtn" style="color:var(--red);border-color:rgba(239,68,68,.3)" onclick="doLogout()">Logout</div>
  </div>
</div>
<button class="locbtn" id="locBtn" style="display:none;bottom:355px" onclick="locateMe()">üìç</button>

<div class="sheet" id="rSheet">
  <div class="hdl"></div>
  <div class="scr on" id="sHome">
    <div style="font-size:.68rem;color:var(--muted);font-weight:700;margin-bottom:11px;letter-spacing:.08em;text-transform:uppercase">WHERE TO, <span id="riderName">RIDER</span>?</div>
    <div class="lbs">
      <div class="lb">
        <div class="pdot"></div>
        <div style="flex:1;min-width:0">
          <div style="font-weight:700;font-size:.87rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis" id="pAddr">Detecting location...</div>
          <div id="pSub" style="display:flex;align-items:center;gap:5px;margin-top:2px;font-size:.68rem;color:var(--muted)"><div class="lspin"></div><span>Getting address...</span></div>
        </div>
        <div onclick="refreshGPS()" style="font-size:.95rem;cursor:pointer;opacity:.55;padding:4px;flex-shrink:0">üîÑ</div>
      </div>
      <div class="lb" style="overflow:visible;position:relative">
        <div style="width:10px;height:10px;background:var(--red);border-radius:50%;flex-shrink:0"></div>
        <div class="acw">
          <input type="text" id="dropIn" placeholder="Enter drop location" autocomplete="off"
            style="background:transparent;border:none;color:var(--text);width:100%;font-family:'DM Sans',sans-serif;font-weight:600;font-size:.87rem;outline:none"
            oninput="onDropIn(this.value)"
            onkeydown="if(event.key==='Enter'){closeAC();calcFare();}"
            onfocus="if(this.value.length>2)onDropIn(this.value)">
          <div class="ac-list" id="acList"></div>
        </div>
      </div>
    </div>
    <div id="homeErr" class="eb"></div>
    <button class="mbtn y" id="findBtn" onclick="calcFare()">Find Driver üöó</button>
  </div>

  <div class="scr" id="sFare">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:13px">
      <div style="font-family:'Syne',sans-serif;font-size:.98rem;font-weight:800">Select Ride</div>
      <span style="color:var(--red);font-weight:700;font-size:.83rem;cursor:pointer" onclick="goScr('sHome')">‚úï Back</span>
    </div>
    <div class="chips">
      <div class="chip"><div class="cv" id="cDist">--</div><div class="cl">KM</div></div>
      <div class="chip"><div class="cv" id="cETA">--</div><div class="cl">MINS</div></div>
      <div class="chip"><div class="cv" id="cZone">--</div><div class="cl">ZONE</div></div>
    </div>
    <div class="ro-card sel" id="optAuto" onclick="selRide(this,'JDP Auto','auto')">
      <div style="font-size:1.9rem">üõ∫</div>
      <div style="flex:1;margin-left:12px"><div style="font-weight:800;font-size:.95rem">JDP Auto</div><div style="font-size:.7rem;color:var(--muted)">~3 min ‚Ä¢ 3 seater</div></div>
      <div style="font-weight:900;font-size:1.2rem;font-family:'Syne',sans-serif">‚Çπ<span id="fAuto">--</span></div>
    </div>
    <div class="ro-card" id="optMini" onclick="selRide(this,'Mini Cab','cab')">
      <div style="font-size:1.9rem">üöó</div>
      <div style="flex:1;margin-left:12px"><div style="font-weight:800;font-size:.95rem">Mini Cab</div><div style="font-size:.7rem;color:var(--muted)">~5 min ‚Ä¢ 4 seater</div></div>
      <div style="font-weight:900;font-size:1.2rem;font-family:'Syne',sans-serif">‚Çπ<span id="fMini">--</span></div>
    </div>
    <button class="mbtn y" id="bookBtn" onclick="confirmBook()">Book <span id="bookBtnType">JDP Auto</span> ‚Üí</button>
  </div>

  <div class="scr" id="sFind">
    <div class="rdr">
      <div class="rdr-rings"><div class="r1"></div><div class="r2"></div><div class="r3"></div><div class="r4"></div></div>
      <div style="font-family:'Syne',sans-serif;font-weight:900;font-size:1.08rem">Finding nearby drivers...</div>
      <div style="color:var(--muted);font-size:.78rem;margin-top:5px">Live request sent to Firebase</div>
      <div style="margin-top:14px;background:rgba(59,130,246,.08);border:1px solid rgba(59,130,246,.2);border-radius:11px;padding:10px">
        <div style="font-size:.68rem;color:var(--muted);font-weight:600;text-transform:uppercase;letter-spacing:.04em">Online Drivers</div>
        <div style="font-family:'Syne',sans-serif;font-weight:900;font-size:1.4rem;color:var(--blue);margin-top:3px" id="nearbyCount">--</div>
      </div>
      <button class="mbtn ro" style="max-width:180px;margin:16px auto 0" onclick="cancelBook()">Cancel</button>
    </div>
  </div>

  <div class="scr" id="sAssigned">
    <div style="background:rgba(16,185,129,.1);color:var(--green);padding:9px;border-radius:11px;text-align:center;font-weight:800;margin-bottom:13px;border:1px solid rgba(16,185,129,.25);font-size:.88rem">‚úÖ Driver Assigned!</div>
    <div class="dcard">
      <div class="dava">üë®üèΩ‚Äç‚úàÔ∏è</div>
      <div style="flex:1">
        <div style="font-family:'Syne',sans-serif;font-weight:900;font-size:1.02rem" id="aDName">--</div>
        <div style="font-size:.76rem;color:var(--muted);margin-top:2px" id="aVeh">--</div>
        <div style="font-size:.73rem;color:var(--yellow);font-weight:700;margin-top:2px">‚òÖ 4.8 Rating</div>
      </div>
      <div class="otp">
        <div style="font-size:.58rem;color:var(--muted);font-weight:700;letter-spacing:.04em;text-transform:uppercase">OTP</div>
        <div style="font-family:'Syne',sans-serif;font-weight:900;font-size:1.35rem;color:var(--yellow)" id="rideOTP">----</div>
      </div>
    </div>
    <div class="sbadge b" id="dTrackBadge">
      <div class="sbd" style="background:var(--blue);box-shadow:0 0 6px var(--blue);animation:dpulse 1.5s infinite"></div>
      <span id="dTrackTxt">Tracking driver location...</span>
    </div>
    <div class="sbadge g"><div class="sbd" style="background:var(--green);box-shadow:0 0 6px var(--green)"></div><span>Within service zone</span></div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
      <button class="mbtn g" style="margin-top:0" onclick="locateMe()">üìç My Location</button>
      <button class="mbtn ro" style="margin-top:0" onclick="cancelRide()">Cancel Ride</button>
    </div>
  </div>
</div>

<div id="dTopBar">
  <div class="d-nr">
    <div class="d-nm">üöñ <span id="dName">Driver</span></div>
    <div style="display:flex;align-items:center;gap:9px">
      <span style="font-size:.72rem;font-weight:700;color:rgba(255,255,255,.6)" id="onlineLbl">OFFLINE</span>
      <label class="tgsw"><input type="checkbox" id="onTog" onchange="toggleOnline()"><div class="tgtr"></div><div class="tgth"></div></label>
    </div>
  </div>
</div>

<div id="dStats">
  <div class="dsr">
    <div class="dst"><div class="dsv" id="dsEarn">‚Çπ0</div><div class="dsl">Today</div></div>
    <div class="dst"><div class="dsv" id="dsRides">0</div><div class="dsl">Rides</div></div>
    <div class="dst"><div class="dsv" id="dsRating">5.0‚òÖ</div><div class="dsl">Rating</div></div>
    <div class="dst"><div class="dsv" id="dsTime">0h</div><div class="dsl">Online</div></div>
  </div>
</div>

<div id="dPanel">
  <div id="dOff">
    <div style="font-size:2.6rem;margin-bottom:9px">üò¥</div>
    <div style="font-family:'Syne',sans-serif;font-weight:900;font-size:1.1rem;margin-bottom:5px">You are Offline</div>
    <div style="font-size:.8rem;color:var(--muted);margin-bottom:16px">Go online to receive real ride requests</div>
    <button class="mbtn g" onclick="document.getElementById('onTog').checked=true;toggleOnline()">üü¢ Go Online & Start Earning</button>
  </div>
  <div id="dOn">
    <div class="opulse">
      <div class="odpulse"></div>
      <div>
        <div style="font-weight:700;font-size:.88rem">Online ‚Äî Listening for Rides</div>
        <div style="font-size:.7rem;color:var(--muted);margin-top:1px" id="dLocTxt">Sharing location...</div>
      </div>
    </div>
    <div class="sbadge g"><div class="sbd" style="background:var(--green);box-shadow:0 0 6px var(--green)"></div><span id="dZoneTxt">In Service Zone</span></div>
  </div>
  <div id="dNav">
    <div style="font-family:'Syne',sans-serif;font-weight:800;font-size:.85rem;margin-bottom:11px;color:var(--muted);text-transform:uppercase;letter-spacing:.04em" id="navLbl">üîµ Going to Pickup</div>
    <div class="nstep bl" id="navP">
      <div class="nicon">üìç</div>
      <div style="flex:1;min-width:0">
        <div style="font-size:.64rem;color:var(--muted);font-weight:700;text-transform:uppercase">PICKUP</div>
        <div style="font-weight:700;font-size:.87rem;margin-top:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis" id="navPA">--</div>
      </div>
      <div style="text-align:right;flex-shrink:0">
        <div style="font-family:'Syne',sans-serif;font-weight:800;color:var(--blue);font-size:.9rem" id="navPD">--</div>
        <div style="font-size:.62rem;color:var(--muted)" id="navPE">-- min</div>
      </div>
    </div>
    <div class="nstep gr">
      <div class="nicon">üèÅ</div>
      <div style="flex:1;min-width:0">
        <div style="font-size:.64rem;color:var(--muted);font-weight:700;text-transform:uppercase">DROP</div>
        <div style="font-weight:700;font-size:.87rem;margin-top:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis" id="navDA">--</div>
      </div>
      <div style="text-align:right;flex-shrink:0">
        <div style="font-family:'Syne',sans-serif;font-weight:800;color:var(--green);font-size:.9rem" id="navFare">‚Çπ--</div>
        <div style="font-size:.62rem;color:var(--muted)">Fare</div>
      </div>
    </div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:9px">
      <button class="mbtn g" style="margin-top:0" id="navActBtn" onclick="driverNext()">‚úÖ Rider Picked Up</button>
      <button class="mbtn ro" style="margin-top:0" onclick="driverCancel()">Cancel</button>
    </div>
  </div>
</div>

<div id="reqPopup">
  <div class="rpc">
    <div style="text-align:center;font-family:'Syne',sans-serif;font-weight:900;font-size:.97rem;margin-bottom:2px">üîî New Ride Request!</div>
    <div class="rtring">
      <svg class="rtsvg" width="60" height="60" viewBox="0 0 60 60">
        <circle class="rtcbg" cx="30" cy="30" r="26"/>
        <circle class="rtc" id="tCircle" cx="30" cy="30" r="26"/>
      </svg>
      <div class="rtn" id="tNum">20</div>
    </div>
    <div style="display:flex;gap:8px;margin-bottom:3px">
      <div style="flex:1;text-align:center;background:rgba(255,255,255,.04);border:1px solid var(--border);border-radius:10px;padding:9px">
        <div style="font-family:'Syne',sans-serif;font-weight:900;font-size:1.05rem;color:var(--yellow)" id="reqFare">‚Çπ--</div>
        <div style="font-size:.58rem;color:var(--muted);font-weight:600;margin-top:1px">FARE</div>
      </div>
      <div style="flex:1;text-align:center;background:rgba(255,255,255,.04);border:1px solid var(--border);border-radius:10px;padding:9px">
        <div style="font-family:'Syne',sans-serif;font-weight:800;font-size:1.05rem" id="reqDist">--</div>
        <div style="font-size:.58rem;color:var(--muted);font-weight:600;margin-top:1px">KM</div>
      </div>
      <div style="flex:1;text-align:center;background:rgba(255,255,255,.04);border:1px solid var(--border);border-radius:10px;padding:9px">
        <div style="font-family:'Syne',sans-serif;font-weight:800;font-size:1.05rem" id="reqETA">--</div>
        <div style="font-size:.58rem;color:var(--muted);font-weight:600;margin-top:1px">MIN</div>
      </div>
    </div>
    <div class="trip-row">
      <div class="tdots"><div class="tdg"></div><div class="tdl"></div><div class="tdr"></div></div>
      <div class="tadd">
        <div class="ta-row"><div class="ta-lbl">Pickup</div><div class="ta-val" id="reqPick">--</div></div>
        <div class="ta-row"><div class="ta-lbl">Drop</div><div class="ta-val" id="reqDrop">--</div></div>
      </div>
    </div>
    <div class="req-btns">
      <button class="mbtn ro" style="margin-top:0" onclick="declineReq()">Decline</button>
      
